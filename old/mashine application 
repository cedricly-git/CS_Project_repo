


import tensorflow as tf
import numpy as np
import matplotlib.pyplot as plt
import os
from tensorflow.keras.preprocessing import image

# === Step 1: Load the trained model ===
model_path = "/Users/graceyan/Downloads/St.Gallen /Computerscience/plant_classifier.keras"  # or wherever your file is
model = tf.keras.models.load_model(model_path)
print("âœ… Model loaded successfully.")

# === Step 2: Define the class names ===
# Use the same order as in training
class_names = ['Edible', 'Flower', 'Grass', 'Succulent', 'Tree']  # adjust if needed

# === Step 3: Prediction function ===
def predict_plant(image_path):
    # Load and preprocess the image
    img = image.load_img(image_path, target_size=(224, 224))
    img_array = image.img_to_array(img) / 255.0
    img_array = np.expand_dims(img_array, axis=0)

    # Make prediction
    preds = model.predict(img_array)
    predicted_index = np.argmax(preds)
    predicted_label = class_names[predicted_index]
    confidence = np.max(preds)

    # Show the image with prediction
    plt.imshow(img)
    plt.axis('off')
    plt.title(f"{predicted_label} ({confidence:.2%})")
    plt.show()

    return predicted_label, confidence

# === Step 4: Use it ===
# Replace this with your image path
image_path = "/Users/graceyan/Downloads/St.Gallen /STUFF/pics/grass-7168204_1280.jpg"
label, confidence = predict_plant(image_path)
print(f"Predicted: {label} ({confidence:.2%})")